+++
title = "Тестирование пакета"
weight = 2
description = "Как проверять пакет до публикации."
+++

Тестирование гарантирует, что пакет работает корректно и не ломает систему.

## Уровни тестирования

1. **Сборка** — нет ошибок в `%build`
2. **Unit-тесты** — если предусмотрены upstream
3. **Smoke-тест** — запуск приложения после установки
4. **Интеграция** — проверка зависимостей

## %check секция

Примеры:

```spec
%check
ctest --output-on-failure
# или
pytest -q
# или
cargo test --release
```

### Опциональные тесты через bcond

Если тесты требуют сеть/GUI, делайте их опциональными:

```spec
%bcond_with tests

%check
%if %{with tests}
%pytest -q
%endif
```

Запуск с тестами:

```bash
rpmbuild -ba package.spec --with tests
```

## Тест на установку

```bash
sudo dnf install ~/rpmbuild/RPMS/x86_64/pkg-*.rpm
pkg --version
```

## Если тесты нестабильны

- Делайте их опциональными через `%bcond_with tests`
- Никогда не запускайте тесты, требующие сети, по умолчанию
  (на ABF сеть обычно недоступна или ограничена)
