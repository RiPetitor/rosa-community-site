+++
title = "Что такое пакет и зачем он нужен"
weight = 1
description = "Проблемы ручной установки, преимущества пакетной системы, роль сборщика."
+++

## Проблема: жизнь без пакетов

Представьте, что вам нужно установить программу из исходников:

```bash
tar -xzf program-1.0.tar.gz
cd program-1.0
./configure
make
sudo make install
```

Выглядит просто, но на практике возникают проблемы:

| Проблема | Описание |
|----------|----------|
| **Зависимости** | Программа требует библиотеки, которых нет в системе. Те требуют другие библиотеки. Вы тонете в цепочке сборок. |
| **Конфликты версий** | Две программы требуют разные версии одной библиотеки. |
| **Удаление** | `make uninstall` часто не работает или отсутствует. Файлы остаются разбросаны по системе. |
| **Обновление** | Как обновить до новой версии? Просто собрать поверх? А если изменились пути? |
| **Отслеживание** | Какие файлы принадлежат какой программе? Что можно безопасно удалить? |
| **Воспроизводимость** | Коллега собрал с другими флагами — у него работает, у вас нет. |

## Решение: пакетная система

Пакет — это **стандартизированный контейнер**, содержащий:

- Файлы программы (бинарники, библиотеки, конфиги, документация)
- Метаданные (имя, версия, описание, лицензия)
- Список зависимостей (что нужно для работы)
- Инструкции установки и удаления

Пакетный менеджер использует эту информацию для:

- **Автоматического разрешения зависимостей** — установит всё необходимое
- **Чистого удаления** — знает все файлы пакета
- **Безопасного обновления** — корректно заменит старую версию
- **Проверки целостности** — убедится, что файлы не повреждены
- **Отката изменений** — можно вернуться к предыдущей версии

## Форматы пакетов

В мире Linux существует несколько форматов пакетов:

| Формат | Дистрибутивы | Пакетный менеджер |
|--------|--------------|-------------------|
| **RPM** | ROSA, Fedora, openSUSE, RHEL, ALT Linux | dnf, zypper, urpmi |
| **DEB** | Debian, Ubuntu, Mint | apt, dpkg |
| **Pacman** | Arch Linux, Manjaro | pacman |
| **Portage** | Gentoo | emerge |

ROSA Linux использует формат **RPM** (Red Hat Package Manager), один из старейших и наиболее проработанных форматов.

## Кто такой сборщик пакетов

**Сборщик** (packager, maintainer) — это человек, который:

1. **Берёт исходный код** программы (обычно из официального релиза)
2. **Пишет рецепт сборки** (SPEC-файл) с инструкциями
3. **Адаптирует программу** под стандарты дистрибутива
4. **Собирает пакет** в чистом окружении
5. **Публикует** в репозитории для пользователей
6. **Поддерживает** — обновляет, исправляет баги, реагирует на уязвимости

### Ответственность сборщика

Сборщик отвечает за то, чтобы пакет:

- **Корректно устанавливался и удалялся** — не оставлял мусора
- **Не ломал систему** — не перезаписывал чужие файлы
- **Имел правильные зависимости** — работал «из коробки»
- **Соответствовал стандартам** — файлы в правильных местах
- **Был воспроизводимым** — любой мог пересобрать с тем же результатом

<div class="warning">
  <div class="title">Важно понимать</div>
  Сборщик — не разработчик программы. Он не исправляет баги в коде (кроме критичных). Его задача — качественно упаковать то, что выпустили авторы.
</div>

## Upstream и downstream

В мире пакетов используют термины:

- **Upstream** — оригинальный проект, его авторы и релизы
- **Downstream** — дистрибутив, который упаковывает проект для своих пользователей

```
[Upstream: авторы программы]
         ↓
    выпускают релиз
         ↓
[Downstream: сборщик ROSA]
         ↓
    упаковывает в RPM
         ↓
[Пользователь ROSA]
    устанавливает через dnf
```

Сборщик находится «между» upstream и пользователями. Он следит за новыми релизами, адаптирует их под дистрибутив и доставляет пользователям.

## Типы пакетов

По содержимому пакеты делятся на:

| Тип | Содержит | Пример |
|-----|----------|--------|
| **Бинарный** | Готовые к запуску файлы | `firefox-115.0-1.x86_64.rpm` |
| **Исходный (SRPM)** | SPEC-файл + исходники | `firefox-115.0-1.src.rpm` |
| **noarch** | Платформо-независимый код | `python3-requests-2.28.0-1.noarch.rpm` |
| **debuginfo** | Отладочные символы | `firefox-debuginfo-115.0-1.x86_64.rpm` |
| **devel** | Заголовки и файлы для разработки | `openssl-devel-3.0.8-1.x86_64.rpm` |

## Жизненный цикл пакета

```
1. Upstream выпускает новую версию
           ↓
2. Сборщик скачивает исходники
           ↓
3. Обновляет SPEC-файл (версия, changelog)
           ↓
4. Собирает локально, тестирует
           ↓
5. Отправляет на сборочную ферму (ABF)
           ↓
6. Сборка в чистом окружении
           ↓
7. Автоматические проверки (rpmlint)
           ↓
8. Публикация в репозитории
           ↓
9. Пользователи получают обновление через dnf
```

## Проверьте понимание

Ответьте на вопросы:

1. Почему `make install` — плохой способ установки программ?
2. Что содержит RPM-пакет помимо файлов программы?
3. Чем отличается работа сборщика от работы разработчика программы?
4. Что такое SRPM и зачем он нужен?

---

**Далее:** [Внутреннее устройство RPM](@/community/beginner/01-concepts/rpm-structure.md)
